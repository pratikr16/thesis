---
title: GAMs for Hypothesis 1 - 3, geese.org data
---
```{r set_env, message=FALSE}
#'load knitr
library(knitr);library(plyr);library(dplyr);library(data.table);library(purrr);library(ggplot2)

#'load model libs
library(gam);library(mgcv);library(gamm4);library(itsadug)

#'suppress all code output but run code
opts_chunk$set(eval = FALSE)
```

```{r load_data}
#'load data.goose.clean
source("dataprep.R")

geeseorg$pred = as.factor(geeseorg$pred)
```

```{r bryear_to_factor}
#'set the breeding year to be a factor
geeseorg =  geeseorg %>% filter(breedyr >= 2001, lon > 0, lon < 10)

geeseorg$breedyr = as.factor(as.character(geeseorg$breedyr))
```

# Hypotheses 01, 02 and 03

1. Families with more juveniles are found in the west, and, 
2. Families with more juveniles are found in smaller flocks, and,
3. Family size decreases over the winter.

Data used: Family size data (10850 individual observations).

Run the same gamm as previously used in code026: mod06. Include individual as a random factor. Food_type is not noted, remove it. Nor is flocksize and observer.

```{r mod}
#'add individual id as a random effect since individuals are resighted frequently.

mod.geeseorg = gamm(famsize ~ s(lon) + t_to_out, random = list(breedyr=~1, id=~1), data = geeseorg, family = poisson, na.action = na.exclude)
```

```{r}
summary(mod.geeseorg$gam)

a = resid(mod.geeseorg$lme)

a = a[a>0]
qqnorm(a)

plot(mod.geeseorg$gam, all.terms = T)
```




