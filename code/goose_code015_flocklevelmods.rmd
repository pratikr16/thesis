---
title: Flock level models
---

# Source data

```{r load_dataprep}
library(maps); library(sjPlot)
source("dataprep.R")

geese$Breeding_year = as.factor(geese$Breeding_year)
fams$Breeding_year = as.factor(fams$Breeding_year)

geese = geese %>% filter(lon < 7)
```

# Flocksize ~ longitude

Model with flocksize as response, lon-lat, days, p.index, as predictors, others as random effects.

```{r run_glmer}

flockmod = glmer(flocksize ~ lon + lat + days + p.index + (1|Breeding_year) + (1|Observer) + (1|Food_type), data = geese, family = poisson)

```

```{r summary}
summary(flockmod)

sjp.glmer(flockmod, type = "eff")
```

# Number of families ~ flocksize

```{r glmer_fams}
famsmod = glmer(fams ~ log(flocksize) + (1|Breeding_year) + (1|Observer) + (1|Food_type) + (1|zone), data = fams[fams$flocksize > 0,], family = poisson)
```

```{r}
sjp.setTheme(base = theme_bw())
sjp.glmer(famsmod, type = "eff", show.values = T, show.ci = T,
          geom.colors = "")
#qqmath(famsmod)
```

