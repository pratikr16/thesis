---
title: "Family size models"
output:
  pdf_document:
    toc: yes
  html_document:
    toc: yes
---

```{r set_env, message=FALSE, echo=FALSE}
#'load knitr
library(knitr);library(plyr);library(dplyr);library(data.table);library(purrr);library(ggplot2)

#'load model libs
library(gam);library(mgcv);library(gamm4);library(itsadug)

#'load variogram libraries
library(sp);library(gstat)

#'suppress all code output but run code
opts_chunk$set(echo = FALSE)
```

```{r load_rdata, message=FALSE}
load("gamms026forpres.rdata.RData")
source("dataprep.R")
```


# Hypotheses

1. Families with more juveniles are found in the west, and, 
2. Families with more juveniles are found in smaller flocks, and,
3. Family size decreases over the winter.
4. Flock sizes are lower in the west.
5. Larger flocks have more families.

# Hpotheses 1 - 3

## Family size plots

```{r vis.mod03, fig.height=12, fig.width=10}
par(mfrow = c(2,2))
vis.gam(mod03.1, view = c("lon","t_since_in"), type = "response", plot.type = "contour", color = "terrain", main = "famsize: SOVON: days ~ lon")

vis.gam(mod03.gorg, view = c("lon","t_since_in"), type = "response", plot.type = "contour", color = "cm", main = "famsize: geese.org: days ~ lon")

vis.gam(mod03, view = c("p.index","t_since_in"), type = "response", plot.type = "contour", color = "terrain", main = "famsize: SOVON: days ~ p.index")

vis.gam(mod03.gorg, view = c("p.index","t_since_in"), type = "response", plot.type = "contour", color = "cm", main = "famsize: geese.org: days ~ p.index")
par(mfrow = c(1,1))
```

# Hypothesis 04

```{r flocksize_lon}
library(sjPlot)
sjp.setTheme(base = theme_minimal())
sjp.glmer(flockmod, type = "pred.fe", vars = "lon", show.values = T, show.p = T, show.ci = T)
```

---

# H1-3 GAM summaries

## SOVON data summary

```{r summary_sovon_data}
summary(mod03)
```


## geese.org data summary

```{r summary_geeseorg_data}
summary(mod03.gorg)
```

# H1-3 GAM checks

## SOVON data

```{r model_check03}
par(mfrow = c(2,2))
gam.check(mod03)
par(mfrow = c(1,1))
```

## geese.org data

```{r model_check03gorg}
par(mfrow = c(2,2))
gam.check(mod03.gorg)
par(mfrow = c(1,1))
```

---

# H4 model summary

```{r}
summary(flockmod)
```

# H5 model summary

```{r}
summary(famsmod)
```

